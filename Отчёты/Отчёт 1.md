# 1 Отчёт (Вариант 2).md: Технический Анализ Разработанного Модуля

## 1. Архитектура и Технологический Стек

Разработанный программный модуль представляет собой клиент-серверное приложение, реализованное на языке **Python** [1].

| Компонент | Технология | Назначение |
| :--- | :--- | :--- |
| **Бизнес-логика** | Python (`main_app.py`) | Управление заявками, аутентификация, формирование отчетов. |
| **Интерфейс** | Python (`gui.py`) + **PyQt5** | Графический пользовательский интерфейс (GUI). |
| **Управление БД** | Python (`database_module.py`) + `psycopg2` | Подключение и выполнение SQL-запросов к PostgreSQL. |
| **База Данных** | **PostgreSQL** | Хранение всех данных системы. |

## 2. Реализация Алгоритма: Расчет Среднего Времени Ремонта

Ключевым требованием Задания 1 была детализация алгоритма. В модуле `main_app.py` [2] реализована функция `calculate_average_repair_time`, которая выполняет эту задачу.

### 2.1. Особенности Реализации

1.  **SQL-фильтрация:** Вместо программной фильтрации данных, используется SQL-запрос для выборки только тех записей, которые соответствуют критерию "Выполнена" (`status_name = 'Выполнена'`) и находятся в заданном временном интервале. Это значительно снижает нагрузку на клиентскую часть и повышает производительность при работе с большими объемами данных.
2.  **Обработка Дат:** Расчет времени ремонта основан на разнице между полями `date_start_work` и `date_completed`. Использование встроенных типов данных `TIMESTAMP WITH TIME ZONE` в PostgreSQL и объекта `timedelta` в Python обеспечивает высокую точность расчета.
3.  **Обработка Исключений:** В цикле итерации предусмотрена проверка на наличие обеих дат (`if start_time and end_time:`), что предотвращает ошибки при расчете для неполных или некорректных записей.

## 3. Соответствие Стандартам Кодирования и Обработка Ошибок

### 3.1. Code Convention

Исходный код (`main_app.py`, `gui.py`) соответствует стандарту **PEP 8** для Python, включая использование стиля **`snake_case`** для идентификаторов.

> "идентификаторы должны соответствовать соглашению об именовании, например (CodeConvention), стилю... snake_case (для Python)" [3]

### 3.2. Механизмы Обработки Исключений

В приложении реализован многоуровневый подход к обработке исключений, что соответствует требованию о программной обработке исключительных ситуаций:

| Уровень | Файл | Тип Обработки | Пример |
| :--- | :--- | :--- | :--- |
| **База Данных** | `database_module.py` [4] | `try-except` для `psycopg2.OperationalError` | Перехват ошибок подключения и выполнения SQL-запросов. |
| **Бизнес-логика** | `main_app.py` [2] | Проверка возвращаемых значений | Проверка успешности аутентификации (`authenticate_user`) или регистрации (`register_client`). |
| **Интерфейс** | `gui.py` [5] | `QMessageBox` | Уведомление пользователя о неверном вводе, ошибках аутентификации или отсутствии прав доступа. |

## 4. Тестирование и Отладка

Тестирование модуля проводилось с акцентом на **функциональное тестирование** ключевых бизнес-процессов.

| Тестируемая Функция | Сценарий Тестирования | Ожидаемый Результат |
| :--- | :--- | :--- |
| **`add_new_request`** | Создание заявки с корректными `client_id` и `type_id`. | Заявка успешно добавлена в БД со статусом "Новая". |
| **`authenticate_user`** | Попытка входа с неверным паролем. | Функция возвращает `None`, интерфейс отображает `QMessageBox.critical`. |
| **`get_status_report`** | Запрос отчета после изменения статуса нескольких заявок. | Отчет корректно отражает новое количество заявок в каждом статусе. |

## Ссылки

[1] Репозиторий проекта: `MrBombastick08/Education-practice-3`
[2] Файл бизнес-логики: `Education-practice-3/main_app.py`
[3] Техническое задание: Требование к Code Convention.
[4] Файл управления БД: `Education-practice-3/database_module.py`
[5] Файл интерфейса: `Education-practice-3/gui.py`
